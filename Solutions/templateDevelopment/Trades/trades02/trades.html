<!-- Header Start -->
<base href="http://ir.euroinvestor.com/solutions/AFAB/2270/trades.aspx" target="_blank">
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html dir="lrt">
<head>
<title>IR Solutions, Euroinvestor</title>
<link rel="stylesheet" type="text/css" media="screen" href="/inc/css/ir.normalize.css?v=635960691510356812" />
<link rel="stylesheet" type="text/css" media="screen" href="/inc/css/ir.style.css?v=636035058565257347" />
<link rel="stylesheet" type="text/css" href="inc/fonts/stylesheet.css"/>
<link rel="stylesheet" type="text/css" media="screen" href="/inc/css/core/ir.tool.trades.css?v=635979478292228720" />
<link rel="stylesheet" type="text/css" media="screen" href="http://localhost:9000/AFAB/2270/ir.client.css?v=636016912976050024" />
</head>
<body>

<!-- Header End -->

<div class="IRTradesModule"></div>

<script type="text/javascript">
    var activeModules = ['IRTrades'];
</script>

<script id="IRTradesTemplate" type="text/x-handlebars-template">

  
    <div class="">
        <div id="prevClose">{{stocks/prevClose}}</div>
        {{stocks/changePercent}}
    </div>
    <table class="IRTradesModule table-look horizontal responsive" id="scroll-table">
        <thead>
            {{#headers}}
            <tr>
                <th class="Header column-first updated" style="text-align: left;">{{t_updated}}</th>
                <th class="Header hidden timestampFull"></th>
                <th class="Header price">{{t_price}} (SEK)</th>
                <th class="Header changePercentage">{{t_change}} (%)</th>
                <th class="Header change">{{t_change}} (SEK)</th>
                <th class="Header column-last volume">{{t_volume}}</th>
            </tr>
            {{/headers}}
        </thead>
        <tbody style="width: 100%;">
            {{#data}}
            {{#data}}
            <tr>
                <td class="Data column-first updated" datetime="{{showDateTime timestamp}}">{{showTime timestamp}}</td>
                <td class="Data hidden timestampFull">{{timestamp}}</td>
                <td class="Data price">{{decimals tradePrice}}</td>
                <td class="Data changePercentage">{{showTradeChangePercentage tradePrice}} %</td>
                <td class="Data change">{{showTradeChange tradePrice}}</td>
                <td class="Data column-last volume">{{tradeVolume}}</td>
            </tr>
            {{/data}}
            {{/data}}
        </tbody>
    </table>
</script>

<!-- Footer Start -->

<div class="disclaimer disclaimer-IRTrades">
<span class="disclaimer-copyright">Copyright &copy; 1997-2016 <a href="http://www.euroinvestor.com/ir/">Euroinvestor</a> </span><span class="disclaimer-dataSource">and our data suppliers. </span><span class="disclaimer-delayed">Data delayed by 15-20 min.</span><span class="disclaimer-terms"> <a href="http://ir.euroinvestor.com/disclaimer/terms_conditions.aspx">See Terms of use</a></span></div>
<script type="text/javascript" src="/includes/js/libs/jquery2-1-4.min.js?v=635808478220682775"></script>
<script type="text/javascript" src="ir.client.js?v=636016912976167216"></script>
<script type="text/javascript" src="/inc/scripts/core/ir.util.js?v=636038531330798541"></script>
<script type="text/javascript" src="/inc/scripts/bootstrap/3_2_0/bootstrap.min.js?v=635979478298352876"></script>
<script type="text/javascript" src="/includes/js/libs/handlebars1-3-0.min.js?v=635808478214120447"></script>
<script type="text/javascript" src="/includes/js/libs/moment2-7-0.min.js?v=635808478220995253"></script>
<script type="text/javascript" src="/includes/js/libs/moment-timezone0-3-1.min.js?v=635808478220995253"></script>
<script type="text/javascript" src="/inc/scripts/moment/moment-timezone-with-data-2010-2020.min.js?v=635808478211933009"></script>
<script type="text/javascript" src="/inc/scripts/browserSupport/respond.min.js?v=635979478298523004"></script>
<script type="text/javascript" src="/inc/scripts/ir.reset.js?v=635979478297302170"></script>
<script type="text/javascript" src="/inc/scripts/core/ir.behaviour.js?v=636035758083067935"></script>
<script type="text/javascript" src="/inc/scripts/core/ir.util.data.js?v=636035065599684865"></script>
<script type="text/javascript" src="/inc/scripts/jquery/jquery.dataTables.min.js?v=635808478210809722"></script>
<script type="text/javascript" src="/inc/scripts/tools/dataTables.scroller.min.js?v=635808478212245500"></script>
<script type="text/javascript" src="/inc/scripts/core/ir.util.draw.js?v=636035746958400797"></script>
</body>
</html>

<!-- Footer End -->

<script type="text/javascript">

    var updateColspanOnResize = 0;
    var globalColspanAmount = 0;

    $(document).ready(function () {
        setTimeout(function () {
            //Scroll Table
            $('#scroll-table').dataTable({
                "scrollY": "336px",
                "scrollCollapse": true,
                "bSort": false,
                "paging": false
            });
			//$('.dataTables_scrollBody').css({'overflow-y','scroll');
            //Show Tooltip
            $('.show-tooltip').mouseenter(function () {
                if ($(window).width() < 572) {
                    var that = $(this);
                    that.tooltip('show');
                    setTimeout(function () {
                        that.tooltip('hide');
                    }, 2000);
                }

                $('.show-tooltip').mouseleave(function () {
                    $(this).tooltip('hide');
                });
            });


            //Compare Trade Price, Percentage Change and Price Change
            var prevClose = globalRawStockData[globalActiveListingIndex].prevClose;

            $(".IRTradesModule tr").each(function () {

                var currPrice = Number($(this).find("td.price").html());
                var currChange = Number($(this).find("td.change").html());
                var tdChangePercentage = $(this).find("td.changePercentage").text().replace('%', '');
                var currChangePercentage = Number(tdChangePercentage);
                var thisHTMLTradePriceChange = '';

                if (currPrice > 0 && prevClose > 0) {
                    // Compare Price
                    thisHTMLTradePriceChange = $(this).find("td.price").html();

                    if (currPrice > prevClose) {
                        $(this).find("td.price").addClass('formatColourPos');
                        thisHTMLTradePriceChange = thisHTMLTradePriceChange + ' <span class="formatArrowPos"></span>';
                        $(this).find("td.changePercentage").addClass('formatColourPos');
                        $(this).find("td.change").addClass('formatColourPos');
                    }

                    else if (currPrice == prevClose) {
                        $(this).find("td.price").addClass('formatColourDef');
                        thisHTMLTradePriceChange = thisHTMLTradePriceChange + ' <span class="formatArrowDef"></span>';
                    }

                    else {
                        $(this).find("td.price").addClass('formatColourNeg');
                        thisHTMLTradePriceChange = thisHTMLTradePriceChange + ' <span class="formatArrowNeg"></span>';
                        $(this).find("td.changePercentage").addClass('formatColourNeg');
                        $(this).find("td.change").addClass('formatColourNeg');
                    }

                    $(this).find("td.price").html(thisHTMLTradePriceChange);


                    // Compare Percentage Change
                    //thisHTML = $(this).find("td.changePercentage").html();

                    //if (currChangePercentage > 0) {
                    //    $(this).find("td.changePercentage").addClass('formatColourPos');
                    //}

                    //else if (currChangePercentage == 0) {
                    //}

                    //else {
                    //    $(this).find("td.changePercentage").addClass('formatColourNeg');
                    //}

                    //$(this).find("td.changePercentage").html(thisHTML);

                   
                    // Compare Price Change
                    //thisHTML = '';
                    //thisHTML = $(this).find("td.change").html();

                    //if (currChange > 0) {
                    //    $(this).find("td.change").addClass('formatColourPos');
                    //}

                    //else if (currChange == 0) {
                    //    // do nothing
                    //}

                    //else {
                    //    $(this).find("td.change").addClass('formatColourNeg');
                    //}

                    //$(this).find("td.change").html(thisHTML);
                }
            });


            //Table Seperator

            var amountOfTDs = 0;
            var amountofTRsToSkip = 1;

            $("#scroll-table tr").each(function () {

                //To display date in IE and Safari
                var currDate = new moment($(this).find("td.timestampFull").html());
                var prevDate = new moment($(this).next().find("td.timestampFull").html());


                var currTime = getTime(currDate);
                var prevTime = getTime(prevDate);

                currDate = getSimpleDate(currDate);
                prevDate = getSimpleDate(prevDate);

                var thisHTML = '';


                amountOfTDs = Number($(this).find('td:visible').length);
                globalColspanAmount = amountOfTDs;


                if (new moment(prevDate) < new moment(currDate)) {
                    if (amountofTRsToSkip == 0) {
                        $(this).before('<tr><td class="table-seperator" colspan="' + amountOfTDs + '"><hr /><div> ' + new moment(currDate).format(clientStyle.formatDate) + ' </div></td></tr>');
                        $(this).after('<tr><td class="table-seperator" colspan="' + amountOfTDs + '"><hr /><div> ' + new moment(prevDate).format(clientStyle.formatDate) + ' </div></td></tr>');
                    } else {
                        $(this).after('<tr><td class="table-seperator" colspan="' + amountOfTDs + '"><hr /><div> ' + new moment(prevDate).format(clientStyle.formatDate) + ' </div></td></tr>');
                    }
                }
                else {
                    if (amountofTRsToSkip == 0) {
                        $(this).before('<tr><td class="table-seperator" colspan="' + amountOfTDs + '"><hr /><div> ' + new moment(currDate).format(clientStyle.formatDate) + ' </div></td></tr>');
                    }
                }
                amountofTRsToSkip--;
            });

            $('#scroll-table tr').eq(2).each(function () {
                $(this).find("td").addClass('strong');
            });

        }, 300);

        function getTime(ts) {
            var thisHTMLDateTime = new Date(ts);

            var hours = thisHTMLDateTime.getHours();
            if (hours < 10) {
                hours = '0' + hours;
            }
            var minutes = thisHTMLDateTime.getMinutes();
            if (minutes < 10) {
                minutes = '0' + minutes;
            }

            var simpleTime = hours + ':' + minutes;
            return simpleTime;
        }

        function getSimpleDate(ts) {
            var thisHTMLDateTime = new Date(ts);

            var month = thisHTMLDateTime.getMonth() + 1;
            if (month < 10) {
                month = '0' + month;
            }
            var day = thisHTMLDateTime.getDate();
            if (day < 10) {
                day = '0' + day;
            }

            var simpleDate = thisHTMLDateTime.getFullYear() + '-' + month + '-' + day;
            return simpleDate;
        }

        setInterval(function () { updateColspan() }, 200);

    });

    // Check if amountOfTDs has changed on windows resize - if yes, apply new value.
    $(window).resize(function () {
        updateColspanOnResize = 1;
    });

    function updateColspan() {

        if (updateColspanOnResize == 1) {
            updateColspanOnResize = 0;
            $("#scroll-table tr").each(function () {
                amountOfTDs = Number($(this).find('td:visible').length);

            });

            if (amountOfTDs != globalColspanAmount) {
                $('.table-seperator').attr('colspan', amountOfTDs);
                globalColspanAmount = amountOfTDs;
            }
        }

        $('#scroll-table').css('width', '100%');
    }

    Handlebars.registerHelper('showTradeChange', function (tradePrice) {
        var prevClose = globalRawStockData[globalActiveListingIndex].prevClose;
        return formatDecimal(tradePrice - prevClose);
    });
    Handlebars.registerHelper('showTradeChangePercentage', function (tradePrice) {
        var prevClose = globalRawStockData[globalActiveListingIndex].prevClose;
        return formatDecimal(((tradePrice - prevClose) / prevClose) * 100);
    });
</script>
